{
  "name": "Show payment form",
  "description": "Show the form to process a Payfast payment.",
  "documentation": "https://developers.payfast.co.za/docs",
  "fields": [
    {
        "label": "",
        "properties": {
            "fieldType": "paragraph",
            "default": "<strong>Important:</strong> This task needs to be '<strong>published</strong>' in order to be shown to a public, anonymous user."
        },
        "readonly": false,
        "required": false,
        "visible": false
    },
    {
      "label": "Firstname",
      "properties": {
        "parameter": "firstname",
        "fieldType": "text",
        "helptext": "The customer's firstname."
      },
      "readonly": false,
      "required": true,
      "visible": false
    },
    {
      "label": "Lastname",
      "properties": {
        "parameter": "lastname",
        "fieldType": "text",
        "helptext": "The customer's lastname."
      },
      "readonly": false,
      "required": true,
      "visible": false
    },
    {
      "label": "Email address",
      "properties": {
        "parameter": "email",
        "fieldType": "email",
        "helptext": "The customer's email address.<br/><strong>Required</strong> if no mobile number is provided."
      },
      "readonly": false,
      "required": false,
      "visible": false
    },
    {
      "label": "Mobile number",
      "properties": {
        "parameter": "mobile",
        "fieldType": "text",
        "helptext": "The customer's mobile number.<br/><strong>Required</strong> if no email address is provided."
      },
      "readonly": false,
      "required": false,
      "visible": false
    },
    {
      "label": "Unique payment ID on the merchant's own system",
      "properties": {
        "parameter": "mPaymentId",
        "fieldType": "text"
      },
      "readonly": false,
      "required": false,
      "visible": false
    },
    {
      "label": "Amount",
      "properties": {
        "parameter": "amount",
        "fieldType": "text",
        "helptext": "The amount (including cents) which the payer must pay in ZAR, e.g. <strong>199.00</strong>."
      },
      "readonly": false,
      "required": true,
      "visible": false
    },
    {
      "label": "Item name",
      "properties": {
        "parameter": "itemName",
        "fieldType": "text",
        "helptext": "The name of the item being charged for, or in the case of multiple items the order number."
      },
      "readonly": false,
      "required": true,
      "visible": false
    },
    {
      "label": "Item description",
      "properties": {
        "parameter": "itemDescription",
        "fieldType": "text",
        "helptext": "The description of the item being charged for, or in the case of multiple items the order description."
      },
      "readonly": false,
      "required": false,
      "visible": false
    },
    {
      "label": "Notify merchant of payment?",
      "properties": {
          "parameter": "emailConfirmation",
          "fieldType": "radio",
          "choices": [
              {"key": "1", "value": "Yes"},
              {"key": "0", "value": "No"}
          ],
          "default": "false",
          "classes": "inline",
          "helptext": "Whether to send an email confirmation to the merchant of the transaction."
      },
      "readonly": false,
      "required": false,
      "visible": false
    },
    {
      "label": "Confirmation email address",
      "properties": {
        "parameter": "confirmationAddress",
        "fieldType": "email",
        "helptext": "The email address to send the confirmation email to. Using this field will override the global value set in your account for this transaction."
      },
      "readonly": false,
      "required": false,
      "visible": false
    },
    {
      "label": "service_response_uuid",
      "properties": {
        "parameter": "serviceResponseUuid",
        "fieldType": "text",
        "helptext": "UUID for the payment retrieved from Payfast. Auto-retrieved by Kotive."
      },
      "readonly": true,
      "required": false,
      "visible": false
    },
    {
      "label": "service_response_return_url",
      "properties": {
        "parameter": "serviceResponseReturnUrl",
        "fieldType": "text",
        "helptext": "URL for when the payment is successful. Auto-generated by Kotive."
      },
      "readonly": true,
      "required": false,
      "visible": false
    },
    {
      "label": "service_response_cancel_url",
      "properties": {
        "parameter": "serviceResponseCancelUrl",
        "fieldType": "text",
        "helptext": "URL for when the payment is cancelled. Auto-generated by Kotive."
      },
      "readonly": true,
      "required": false,
      "visible": false
    },
    {
      "label": "pf_payment_id",
      "properties": {
        "parameter": "pfPaymentId",
        "fieldType": "text",
        "helptext": "Payfast payment ID when payment has been successful."
      },
      "readonly": true,
      "required": true,
      "visible": false
    }
  ],
  "method": "POST",
  "headers": {
    "Content-Type": "application/json",
    "Accept": "application/json"
  },
  "endpoint": "/pre",
  "request": {
    "groupId": "{group.id}",
    "processId": "{taskflow.id}",
    "taskId": "{task.id}",
    "passphrase": "{auth.field.passphrase}",
    "merchant_id": "{auth.field.merchantId}",
    "merchant_key": "{auth.field.merchantKey}",
    "return_url": "",
    "cancel_url": "",
    "notify_url": "",
    "name_first":"{field.firstname}",
    "name_last":"{field.lastname}",
    "email_address":"{field.email}",
    "cell_number": "{field.mobile}",
    "m_payment_id": "{field.mPaymentId}",
    "amount": "{field.amount}",
    "item_name": "{field.itemName}",
    "item_description": "{field.itemDescription}",
    "custom_str1": "",
    "custom_str2": "",
    "custom_str3": "",
    "custom_str4": "",
    "custom_str5": "",
    "email_confirmation": "{field.emailConfirmation}",
    "confirmation_address": "{field.confirmationAddress}"
  },
  "response": {}
}
