{
    "name": "Export a file",
    "description": "Exports a Google Doc to the requested file type and returns the exported content.",
    "documentation": "https://developers.google.com/drive/v3/reference/files/export",
    "fields": [
        {
            "label": "File's Id",
            "properties": {
                "parameter": "fileId",
                "fieldType": "text",
                "helptext": "The ID of the file to be exported."
            },
            "readonly": false,
            "required": true,
            "visible": true
        },
        {
            "label": "File type of the exported file",
            "properties": {
                "parameter": "mimeType",
                "fieldType": "select",
                "choices": [
                    {"key": "CSV (first sheet only)", "value": "text/csv"},
                    {"key": "application/epub+zip", "value": "EPUB"},
                    {"key": "text/html", "value": "HTML"},
                    {"key": "application/zip", "value": "HTML (zipped)"},
                    {"key": "image/jpeg", "value": "JPEG"},
                    {"key": "application/vnd.google-apps.script+json", "value": "JSON"},
                    {"key": "MS Excel", "value": "MS Excel"},
                    {"key": "application/vnd.openxmlformats-officedocument.presentationml.presentation", "value": "MS PowerPoint"},
                    {"key": "application/vnd.openxmlformats-officedocument.wordprocessingml.document", "value": "MS Word document"},
                    {"key": "application/vnd.oasis.opendocument.text", "value": "Open Office doc"},
                    {"key": "application/vnd.oasis.opendocument.presentation", "value": "Open Office presentation"},
                    {"key": "Open Office sheet", "value": "Open Office sheet"},
                    {"key": "application/pdf", "value": "PDF"},
                    {"key": "image/png", "value": "PNG"},
                    {"key": "text/plain", "value": "Plain text"},
                    {"key": "application/rtf", "value": "Rich text"},
                    {"key": "image/svg+xml", "value": "SVG"},
                    {"key": "TSV (first sheet only)", "value": "text/tab-separated-values"}
                ],
                "default": "application/pdf",
                "helptext": "The MIME type of the format requested for this export. Refer to the <a href='https://developers.google.com/drive/v3/web/manage-downloads#downloading_google_documents' target='_blank'>table of supported Google export formats</a>."
            },
            "readonly": false,
            "required": true,
            "visible": true
        }
    ],
    "headers": {
      "Content-Type": "application/json",
      "Authorization": "Bearer {auth.oauth2Token}"
    },
    "method": "GET",
    "endpoint": "/files/{field.fileId}/export?mimeType={field.mimeType}",
    "request": {},
    "response": {
        "success": {},
        "error": {}
    }
}
